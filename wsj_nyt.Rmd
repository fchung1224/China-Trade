---
title: "Sentimental Analysis of the Trade War with China"
output: html_document
---

```{r, setup, include = FALSE}
library(tidyverse)
library(ggplot2)
library(ggmap)
library(lubridate)
library(rvest)
library(stringr)
library(tidytext)
library(wordcloud)
library(jsonlite)
library(RCurl)
library(XML)
library(RJSONIO)
library(urltools)
devtools::install_github("mkearney/nytimes")
library(nytimes)
knitr::opts_chunk$set(tidy = FALSE, message=FALSE, cache.extra = packageVersion('tufte'))
options(htmltools.dir.version = FALSE)
```



#NEW YORK TIMES API

##Data Collection
```{r}

#API KEY
key <-"b54a3d8a406247da96456b7bf62ca9ca"

## make path to .Renviron
file <- file.path(path.expand("~"), ".Renviron")

## save environment variable
cat(key, file = file, append = TRUE, fill = TRUE)
```

```{r}
# Tell rtimes what our API key is
Sys.setenv(NYTIMES_AS_KEY = key)
```

```{r}
url <- "http://api.nytimes.com/svc/search/v2/articlesearch.json"
url <- param_set(url, "q", url_encode("trade war"))
url <- param_set(url, "api-key", url_encode(key))
url <- param_set(url, "page",0)
```

```{r}
res1 <- fromJSON(url)

Sys.sleep(1)
url <- param_set(url, "page", 1)
res2 <- fromJSON(url)

Sys.sleep(1)
url <- param_set(url, "page", 2)
res3 <- fromJSON(url)
```

```{r}
docs1 <- res1$response$docs
docs2 <- res2$response$docs
docs3 <- res3$response$docs

names(docs1)
```

```{r}
url <- "http://api.nytimes.com/svc/search/v2/articlesearch.json"
url <- param_set(url, "q", url_encode("Trade War"))
url <- param_set(url, "api-key", url_encode(key))
url <- param_set(url, "page",0)
res1 <- fromJSON(url)

Sys.sleep(1)
url <- param_set(url, "page", 1)
res2 <- fromJSON(url)

Sys.sleep(1)
url <- param_set(url, "page", 2)
res3 <- fromJSON(url)

docs1 <- res1$response$docs
docs2 <- res2$response$docs
docs3 <- res3$response$docs
```

```{r}
docs1$keywords
```


  





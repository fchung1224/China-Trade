raw_survey_data <- read.csv("https://www.macalester.edu/~ajohns24/data/pulse_of_the_nation.csv")
raw_survey_data
names(raw_survey_data) <- c("income", "gender", "age", "party", "trump_approval", "education", "marital", "robots", "climate_change", "transformers", "science_is_honest", "vaccines_are_safe", "books", "ghosts", "fed_sci_budget", "earth_sun", "wise_unwise")
processed_survey_data <- raw_survey_data %>%
mutate_if(is.factor, ~replace(., . == "DK/REF", NA)) %>%      # line 2
mutate_if(is.factor, ~droplevels(.)) %>%                      # line 3
mutate(income = income / 1000) %>%                            # line 4
select(-marital) %>%                                          # line 5
VIM::kNN(imp_var = FALSE)
set.seed(253) # kNN is a random process
processed_survey_data <- raw_survey_data %>%
mutate_if(is.factor, ~replace(., . == "DK/REF", NA)) %>%      # line 2
mutate_if(is.factor, ~droplevels(.)) %>%                      # line 3
mutate(income = income / 1000) %>%                            # line 4
select(-marital) %>%                                          # line 5
VIM::kNN(imp_var = FALSE)
library(ggplot2)  # for plots
library(dplyr)    # for wrangling
library(caret)    # for machine learning algorithms
library(rpart.plot)  # for plotting nice trees
library(VIM)      # for imputing categorical & quantitative data
install.packages("VIM")
library(ggplot2)  # for plots
library(dplyr)    # for wrangling
library(caret)    # for machine learning algorithms
library(rpart.plot)  # for plotting nice trees
library(VIM)      # for imputing categorical & quantitative data
raw_survey_data
names(raw_survey_data) <- c("income", "gender", "age", "party", "trump_approval", "education", "marital", "robots", "climate_change", "transformers", "science_is_honest", "vaccines_are_safe", "books", "ghosts", "fed_sci_budget", "earth_sun", "wise_unwise")
set.seed(253) # kNN is a random process
processed_survey_data <- raw_survey_data %>%
mutate_if(is.factor, ~replace(., . == "DK/REF", NA)) %>%      # line 2
mutate_if(is.factor, ~droplevels(.)) %>%                      # line 3
mutate(income = income / 1000) %>%                            # line 4
select(-marital) %>%                                          # line 5
VIM::kNN(imp_var = FALSE)
raw_survey_data%>%
group_by(climate_change)%>%
summarize(n= n())
tree<-raw_survey_data%>%
select(-income)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.45, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
rpart.plot(tree_model$finalModel)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 20)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 40)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.,
data = tree,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01, 0.2, 0.3, .02)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 7),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
control = rpart.control(minbucket = 7)
metric = "Accuracy",
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
control = rpart.control(minbucket = 7),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.15)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
control = rpart.control(minbucket = 7),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
control = rpart.control(minbucket = 7),
metric = "Accuracy",
na.action = na.omit
)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
rpart.plot(tree_model$finalModel)
tree_model$bestTune$cp
rpart.plot(tree_model$finalModel)
unique(processed_survey_data$trump_approval)
unique(processed_survey_data$education)
unique(processed_survey_data$marital)
levels(processed_survey_data$marital)
(processed_survey_data$marital)
(processed_survey_data$marital)
processed_survey_data$science_is_honest
processed_survey_data$vaccines_are_safe
processed_survey_data$fed_sci_budget
processed_survey_data$wise_unwise
fed<-data.frame(income = 0, gender = "Male", age = 20, party = "Democrat", trump_approval = "Somewhat disapprove", education = "College degree",robots= "Unlikely", climate_change ="Real and Caused by People", transformers =2, science_is_honest="Strongly Agree", vaccines_are_safe="Strongly Agree", books=10, ghosts ="Yes", fed_sci_budget = "Too Low", earth_sun= "FALSE", wise_unwise = "Wise and Unhappy")
predict(tree_model, newdata = fed)
fed<-data.frame(income = 0, gender = "Male", age = 20, party = "Democrat", trump_approval = "Somewhat disapprove", education = "College degree",robots= "Unlikely", transformers =2, science_is_honest="Strongly Agree", vaccines_are_safe="Strongly Agree", books=10, ghosts ="Yes", fed_sci_budget = "Too Low", earth_sun= "FALSE", wise_unwise = "Wise and Unhappy")
predict(tree_model, newdata = fed)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01, 0.2, 0.3, .02)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 7),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
rpart.plot(tree_model$finalModel)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01, 0.2, 0.3, .02)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 30),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
rpart.plot(tree_model$finalModel)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
control = rpart.control(minbucket = 30),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best")
metric = "Accuracy",
# Construct trees
tree_model <- train(
climate_change ~.-income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = seq(0,0.4, length = 30)),
trControl = trainControl(method = "cv", number = 10, selectionFunction = "best"),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01, 0.2, 0.3, .02)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 30),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01, 0.2, 0.3, .02)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 20),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
rpart.plot(tree_model$finalModel)
mean(tree_model$resample$Accuracy)
tree_model$bestTune$cp
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01:0.4)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 20),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
processed_survey_data$wise_unwise
processed_survey_data$wise_unwise
ocessed_survey_data$wise_unwise
mean(tree_model$resample$Accuracy)
tree_model<- train(
climate_change ~ . -income,
data = processed_survey_data,
method = "rpart",
tuneGrid = data.frame(cp = c(0.01:0.4)),
trControl = trainControl(method = "cv", number = 10),
control = rpart.control(minbucket = 20),
metric = "Accuracy",
na.action = na.omit
)
plot(tree_model)
